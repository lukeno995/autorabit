<apex:page standardController="Ispezione_II_Livello__c" extensions="CQS_Isp2L_AdempimentiController" sidebar="false" >
 <Style>
        .red{color:red;}
    </Style>
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>            
    <link rel = "stylesheet"  type = "text/css"  href = "//code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
    <!---apex:include pageName="{!pageName}"/--->
    <apex:pageMessages id="pm"/>
    <apex:sectionHeader title="Ispezione" subtitle="Ispezione di Secondo Livello"/>
    <apex:form id="theForm">
       
        <apex:pageBlock title="Ispezione di Secondo Livello" mode="edit">
          <apex:outputPanel id="ipsecLSS">
          
          	<apex:pageBlockSection title="Ispezione di Secondo Livello" columns="2" collapsible="true">
          
             <apex:actionRegion id="ipsec1" >
                    <apex:pageBlockSectionItem >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <b>Progetto </b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <apex:selectList label="Progetto" value="{!projectName}" size="1"  >
                            <apex:selectOptions value="{!optNomeProgetto}"/>  
                            <apex:actionSupport event="onchange" action="{!defineLDO}"  reRender="ipsec1,ipsecLSS" />
                        </apex:selectList>
                    </apex:pageBlockSectionItem> 
              </apex:actionRegion>
                 <apex:inputField value="{!isp2L.CQS_Isp2L_LDO__c}" />
                 <apex:pageBlockSectionItem />
                 <apex:pageBlockSectionItem />
            <!--      <apex:actionRegion > 
                      
                <label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <b>Comune</b></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <apex:inputText id="comuneId" value="{!searchTerm}" styleClass="form-control" />
                <apex:inputHidden id="searchcommuneId" value="{!selectedIdComune}" />
            </apex:actionRegion> -->
               <apex:inputField value="{!isp2L.CQS_IspIIL_Service__c}"/>
               <apex:inputField value="{!isp2L.CQS_IspIIL_Data__c}" required="true"/> 
               <apex:inputField value="{!isp2L.CQS_Isp2L_Nominativo__c}"/>
              
              <br/>
              <apex:pageBlockSectionItem />
  			  <apex:pageBlockSectionItem />
             </apex:pageBlockSection>
   			</apex:outputPanel>
            
            <apex:outputPanel id="AdempimentiContrattualiRL">
            <apex:pageBlockSection title="Adempimenti Contrattuali" columns="2" collapsible="true">       
              
                <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />
                <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_Nomina_CoordSic_faseProg__c}" required="true">
                       <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb" col="2"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_Nomina_CoordSic_faseProg__c.inlineHelpText}"  />
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_Nomina_CoordSic_faseEsec__c}" required="true">
                       <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_Nomina_CoordSic_faseEsec__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_Trasmissione_PSC_ImpAff__c}" required="true">
                       <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_Trasmissione_PSC_ImpAff__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_Trasm_Coord_Sic_ImpEsec__c}" required="true">
                      <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_Trasm_Coord_Sic_ImpEsec__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_Idoneita_TecProf_ImpEsec__c}" required="true">
                      <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_Idoneita_TecProf_ImpEsec__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_Trasm_NotPrelim_orgComp__c}" required="true">
                      <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_Trasm_NotPrelim_orgComp__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_Dati_NotPrel_ComplCorr__c}" required="true">
                       <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_Dati_NotPrel_ComplCorr__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_PartecRiunCoordPeriod__c}" required="true">
                       <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_PartecRiunCoordPeriod__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_OpCoordSic_faseEsec__c}" required="true">
                        <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_OpCoordSic_faseEsec__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                 <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_Part_RiunGovern_OF__c}" required="true">
                         <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_Part_RiunGovern_OF__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                <apex:selectRadio value="{!isp2L.CQS_Isp2L_ReportAdeguato_toFM__c}" required="true">
                     <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_ReportAdeguato_toFM__c.inlineHelpText}"/>
                    </span>
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />
                <apex:inputField value="{!isp2L.CQS_Isp2L_Note_AdContr__c}"/>
                <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />
                </apex:pageBlockSection>
            </apex:outputPanel>
            
            <apex:outputPanel id="altroRL">
            <apex:pageBlockSection title="Altro" columns="2" collapsible="true">       
                
                <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />
                <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_RL_reattivo__c}" required="true">
                    <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_RL_reattivo__c.inlineHelpText}"/>
                    </span>  
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_RL_presente__c}" required="true">
                     <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_RL_presente__c.inlineHelpText}"/>
                    </span>  
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                <apex:selectRadio value="{!isp2L.CQS_Isp2L_AL2_RL_collaborativo__c}" required="true">
                    <span   class="helpButton"><img src="/s.gif" alt="" class="helpOrb"
          		 title="{!$ObjectType.Ispezione_II_Livello__c.Fields.CQS_Isp2L_AL2_RL_collaborativo__c.inlineHelpText}"/>
                    </span>  
				    <apex:selectOption itemValue="Si" itemlabel="Sì"/>
				    <apex:selectOption itemValue="No" itemlabel="No"/>
				    <apex:selectOption itemValue="NA" itemlabel="N/A"/>
				</apex:selectRadio>
                <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />
                <apex:inputField value="{!isp2L.CQS_Isp2L_Note_Altro__c}"/>
                <apex:pageBlockSectionItem />
                 <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />
                </apex:pageBlockSection>
            </apex:outputPanel>
            
           <apex:outputPanel >
             <apex:pageBlockSection title="Note" collapsible="true">
                <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />
                <apex:inputField value="{!isp2L.CQS_Isp2L_Note_Generali__c}"/>
                <apex:pageBlockSectionItem />
                <apex:pageBlockSectionItem />			  
            </apex:pageBlockSection>
            <apex:pageBlockSection title="Responsabile Redazione Ispezione di Sicurezza" collapsible="true" columns="2">
                <apex:pageBlockSectionItem />
                <apex:outputField label="Responsabile Redazione" value="{!isp2L.Owner.Name}"/>
                <apex:pageBlockSectionItem />
                <p style="margin-left:30px;">            {!$User.FirstName}  {!$User.LastName}</p>
            </apex:pageBlockSection>
            </apex:outputPanel>
            
              <apex:pageBlockButtons > 
         	   <apex:commandButton value="Salva ispezione" action="{!salvaIspezione}"  rerender="ipsec,pb,pm" />
             <apex:commandButton value="Cancel" action="{!backToSel}"/>
         </apex:pageBlockButtons> 
            
         </apex:pageBlock> 
     
              
    
       
        <html lang="en">
           <head>
                <script type="text/javascript">
                var PLACEHOLDER = 'Digita le prime lettere del nome del Comune'; 
                var AccountObjects;
                var queryTerm;                
                $(document).ready(function() {
                    $('[id$=comuneId]').autocomplete({minLength: 2,
                                                      source: function(request, response) {                            
                                                          queryTerm = request.term;
                                                          CQS_Isp2L_AdempimentiController.searchComune(request.term, function(result, event){
                                                              if(event.type == 'exception') {
                                                                  alert(event.message);
                                                              } else {
                                                                  AccountObjects = result;                            
                                                                  console.log('==>'+AccountObjects);
                                                                  response(AccountObjects);
                                                              }
                                                          });
                                                      },
                                                      focus: function( event, ui ) {
                                                          //  $('[id$=comuneId]').val( ui.item.Name);
                                                          return false;
                                                      },
                                                      select: function( event, ui ) {
                                                          $('[id$=comuneId]').val( ui.item.OF_Comune__c  );
                                                          $('[id$=searchcommuneId]').val( ui.item.Id);
                                                          return false;
                                                      },
                                                     })
                    .data( "ui-autocomplete" )._renderItem = function( ul, item ) {
                        var entry = "<a>" + item.OF_Comune__c;
                        
                        entry = entry + "</a>";
                        entry = entry.replace(queryTerm, "<b>" + queryTerm + "</b>");
                        return $( "<li></li>" )
                        .data( "ui-autocomplete-item", item )
                        .append( entry )
                        .appendTo( ul );
                    };
                    
                    // Add or remove placeholder values
                    $('[id$=comuneId]').val(PLACEHOLDER);
                    $('[id$=comuneId]').on("focus",  function(event){
                        $tgt = $(event.target);
                        if($tgt.val() === PLACEHOLDER ){
                            $tgt.val('');
                            $tgt.removeClass('placeHolder');
                        }
                    });
                    $('[id$=comuneId]').on( "blur",  function(event){
                        $tgt = $(event.target);
                        if($tgt.val() === '' ){
                            $tgt.val(PLACEHOLDER);
                            $tgt.addClass('placeHolder');
                        }
                    });
                    
                });
                </script>
            </head>           
        </html>
        
    </apex:form>    
</apex:page>