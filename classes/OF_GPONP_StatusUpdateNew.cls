//Generated by wsdl2apex

public class OF_GPONP_StatusUpdateNew {
    public class StatusUpdate_GPONPEndpoint4 {
        List<OF_Puntamento_Callout__c> listCustomSett =  OF_Puntamento_Callout__c.getAll().values();
    	String puntamento=listCustomSett[0].Tibco_Collaudo__c;
        public String endpoint_x = 'https://'+puntamento+'/New_SF_OLO/StatusUpdate_GPONP';
        //public String endpoint_x = 'http://localhost:7060/New_SF_OLO/StatusUpdate_GPONP';
        public Map<String,String> inputHttpHeaders_x;
        public Map<String,String> outputHttpHeaders_x;
        public String clientCertName_x;
        public String clientCert_x;
        public String clientCertPasswd_x;
        public Integer timeout_x;
        private String[] ns_map_type_info = new String[]{'http://xmlns.example.com/1542281501436', 'OF_GPONP_StatusUpdateNew', 'http://openfiber.it/schemas/New_SF_OLO_Passivi/Response.xsd', 'OF_GPONP_Schema_Res_StatusUpdateNew', 'http://openfiber.it/schemas/OLO_Gateway_SKY/SharedResources/CommonSchema/New_SF_OLO_Passivi/OF_StatusUpdate_GPONP.xsd', 'OF_GPONP_Schema_Req_StatusUpdateNew'};
        public OF_GPONP_Schema_Res_StatusUpdateNew.Response_element StatusUpdate_GPONP(EOF_EAI_Service_Log__C sl) {
            OF_GPONP_Schema_Req_StatusUpdateNew.OF_StatusUpdate_GPONP_element request_x = new OF_GPONP_Schema_Req_StatusUpdateNew.OF_StatusUpdate_GPONP_element();
            request_x.request = new OF_GPONP_Schema_Req_StatusUpdateNew.OF_StatusUpdate_GPONP_Request();
            request_x.request.CODICE_OPERATORE = sl.EOF_CODICE_OPERATORE__c;
            request_x.request.CODICE_ORDINE_OLO = sl.EOF_CODICE_ORDINE_OLO__c;
            request_x.request.CODICE_ORDINE_OF = sl.EOF_CODICE_ORDINE_EOF__c;
            request_x.request.DATA_NOTIFICA = OF_SA_GE_UtilsNew.DateToString(sl.EOF_DATA_NOTIFICA__c);
            request_x.request.ID_NOTIFICA = sl.EOF_ID_NOTIFICA__c;
            request_x.request.STATO_ORDINE = sl.EOF_STATO_ORDINE__c;
            request_x.request.CODICE_MOTIVAZIONE = sl.EOF_CODICE_MOTIVAZIONE__c;
            request_x.request.MOTIVAZIONE = sl.EOF_MOTIVAZIONE__c;
            request_x.request.GPON_DI_ATTESTAZIONE = sl.EOF_GPON_Attestazione__c;
            request_x.request.NOME_CLIENTE = sl.EOF_NOME_CLIENTE__c;
            request_x.request.COGNOME_CLIENTE = sl.EOF_COGNOME_CLIENTE__c;
            request_x.request.RECAPITO_TELEFONICO_CLIENTE = sl.EOF_RECAPITO_TELEFONICO_CLIENTE__c; 
            if(sl.EOF_DATA_PREVISTA_ATTIVAZIONE__c!=null){
                request_x.request.DATA_PREVISTA_ATTIVAZIONE = OF_SA_GE_UTilsNew.dateToStringNoTime(sl.EOF_DATA_PREVISTA_ATTIVAZIONE__c);
            }
            //request_x.DATA_PREVISTA_ATTIVAZIONE = DATA_PREVISTA_ATTIVAZIONE;
            //request_x.ORARIO_APPUNTAMENTO = ORARIO_APPUNTAMENTO;
            if(!String.isBlank(sl.EOF_ORARIO_APPUNTAMENTO__c)){
                request_x.request.ORARIO_APPUNTAMENTO=sl.EOF_ORARIO_APPUNTAMENTO__c;
            }
            request_x.request.PIN_INTERVENTO_A_VUOTO = sl.EOF_PIN_INTERVENTO_A_VUOTO__c;
            request_x.request.NOTE = sl.EOF_NOTE__c;
            request_x.request.FLAG_DESOSPENSIONE = sl.OF_Flag_Desospensione__c;
            //check per i log non ancora inseriti(acquisizione OK/KO e cessazione KO)
            if(String.isNotBlank(sl.Id)){
                List<EOF_EAI_Service_Log__C> sList= [select Id,recordtype.name,OF_SA_NOME_SERVIZIO__c,OF_SA_INFORMAZIONI_SERVIZIO__c,EOF_TIPOLOGIA_APPARATO__C,
                        OF_SA_PASSWORD_APPARATO__C,OF_SA_AZIONE_APPARATO__C,OF_SA_KIT_CONSEGNA_VLAN__C, OF_SA_USER_VLAN__C,OF_SA_SERVICE_VLAN__C,
                        OF_SA_PROFILO_VLAN__C,OF_SA_INFORMAZIONI_VLAN__C,OF_SA_CUSTOMER_VLAN__C,OF_SA_MODELLO_DI_SERVIZIO_VLAN__C,OF_SA_ESITO_RITIRO_APPARATO__C,
                        OF_SA_CODICE_MOTIVAZIONE_RITIRO__C, OF_SA_MOTIVAZIONE_RITIRO__C,EOF_Tipo_COmunicazione_String__c,recordtype.developername 
                        from EOF_EAI_Service_Log__C
                        where OF_SA_VLan_Log__c=:sl.Id OR OF_SA_Servizi_Aggiuntivi_Log__c=:sl.Id OR OF_SA_Cpe_Log__c=:sl.Id]; 
                
                if(!sList.isEmpty()){
                    request_x.request.APPARATO = new OF_GPONP_Schema_Req_StatusUpdateNew.ArrayOf_tns1_ApparatoOF_StatusUpdate_GPONP();
                    request_x.request.APPARATO.item = new List<OF_GPONP_Schema_Req_StatusUpdateNew.ApparatoOF_StatusUpdate_GPONP>();
                    for(EOF_EAI_Service_Log__C sLog : sList){
                        if(sLog.recordtype.developername=='OF_SA_Cpe'){
                            OF_GPONP_Schema_Req_StatusUpdateNew.ApparatoOF_StatusUpdate_GPONP app = new OF_GPONP_Schema_Req_StatusUpdateNew.ApparatoOF_StatusUpdate_GPONP();
                                app.TIPOLOGIA_APPARATO=sLog.EOF_TIPOLOGIA_APPARATO__C;
                                app.ESITO_RITIRO_APPARATO=sLog.OF_SA_ESITO_RITIRO_APPARATO__C; 
                                app.CODICE_MOTIVAZIONE_RITIRO=sLog.OF_SA_CODICE_MOTIVAZIONE_RITIRO__C;
                                app.MOTIVAZIONE_RITIRO=sLog.OF_SA_MOTIVAZIONE_RITIRO__C;
                            request_x.request.APPARATO.item.add(app);  
                        }                         
                    } 
                }
            }
            OF_GPONP_Schema_Res_StatusUpdateNew.Response_element response_x;
            Map<String, OF_GPONP_Schema_Res_StatusUpdateNew.Response_element> response_map_x = new Map<String, OF_GPONP_Schema_Res_StatusUpdateNew.Response_element>();
            response_map_x.put('response_x', response_x);
            WebServiceCallout.invoke(
              this,
              request_x,
              response_map_x,
              new String[]{endpoint_x,
              '/Business/Services/New_SF_OLO/Resources/OF_StatusUpdate_GPONP-service4.serviceagent/StatusUpdate_GPONPEndpoint4/StatusUpdate_GPONP',
              'http://openfiber.it/schemas/OLO_Gateway_SKY/SharedResources/CommonSchema/New_SF_OLO_Passivi/OF_StatusUpdate_GPONP.xsd',
              'OF_StatusUpdate_GPONP',
              'http://openfiber.it/schemas/New_SF_OLO_Passivi/Response.xsd',
              'Response',
              'OF_GPONP_Schema_Res_StatusUpdateNew.Response_element'}
            );
            response_x = response_map_x.get('response_x');
            return response_x;
        }
    }
}