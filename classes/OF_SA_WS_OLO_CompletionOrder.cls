//Generated by wsdl2apex

public class OF_SA_WS_OLO_CompletionOrder {
    public class NotifyPortTypeEndpoint {
    	List<OF_Puntamento_Callout__c> listCustomSett =  OF_Puntamento_Callout__c.getAll().values();
    	String puntamento=listCustomSett[0].OF_OGW__c;
        public String endpoint_x = 'https://'+puntamento+'.ENEL.COM:44300/NotifyServiziAttivi/OF_CompletionOrderOpenStream';
        public Map<String,String> inputHttpHeaders_x;
        public Map<String,String> outputHttpHeaders_x;
        public String clientCertName_x;
        public String clientCert_x;
        public String clientCertPasswd_x; 
        public Integer timeout_x;
        private String[] ns_map_type_info = new String[]{'http://enel.it/schemas/class/ServiziAttivi/Esito', 'OF_SA_WS_OLO_Response', 'http://enel.it/schemas/class/ServiziAttivi/NotificaCompletamentoOrdineGpona', 'OF_SA_WS_OLO_classi', 'http://xmlns.enel.it/OLO_Gatway/wsdl/concrete/ServiziAttivi/NotifyCompletamentoOrdine', 'OF_SA_WS_OLO_CompletionOrder'};
        public OF_SA_WS_OLO_Response.Esito_element NotifyCompletamentoOrdine(List<EOF_EAI_Service_Log__c> sList) {
            OF_SA_WS_OLO_classi.NotificaOrdineGpona_element request_x = new OF_SA_WS_OLO_classi.NotificaOrdineGpona_element();
            EOF_EAI_Service_Log__c slToUpdate = new EOF_EAI_Service_Log__c();
            for(EOF_EAI_Service_Log__c sl : sList){  
            	if(sl.EOF_Tipo_Comunicazione_String__C=='SF-OLO - CompletionOrder'){
            		slToUpdate = sl;
		            request_x.CODICE_OPERATORE =sl.EOF_CODICE_OPERATORE__C;
		            request_x.CODICE_ORDINE_OLO =sl.EOF_CODICE_ORDINE_OLO__C;
		            request_x.CODICE_ORDINE_EOF =sl.EOF_CODICE_ORDINE_EOF__C; 
		            request_x.DATA_NOTIFICA =OF_SA_GE_Utils.DateToString(sl.EOF_DATA_NOTIFICA__C);
		            request_x.ID_NOTIFICA =sl.EOF_ID_NOTIFICA__C;
		            request_x.STATO_ORDINE =sl.EOF_STATO_ORDINE__C;
		            request_x.CODICE_MOTIVAZIONE =sl.EOF_CODICE_MOTIVAZIONE__C;
		            request_x.MOTIVAZIONE =sl.EOF_MOTIVAZIONE__C;
		            request_x.ID_RISORSA =sl.EOF_ID_RISORSA__C;
		            if(sl.EOF_DATA_ESPLETAMENTO_ORDINE__C!=null){
		            	request_x.DATA_ESPLETAMENTO_ORDINE = OF_SA_GE_Utils.DateToStringNoTime(sl.EOF_DATA_ESPLETAMENTO_ORDINE__C);
		            }
		            request_x.SCALA_PALAZZINA =sl.EOF_SCALA_PALAZZINA__C;
		            request_x.DDT =sl.OF_SA_DDT__C;
		            request_x.NOTE =sl.EOF_NOTE__C;
		            
            	}
            }
            if(sList.size()>1){
            	request_x.SERVIZIO_AGGIUNTIVO = new List<OF_SA_WS_OLO_Classi.SERVIZIO_AGGIUNTIVO_element>();
	        	request_x.APPARATO = new List<OF_SA_WS_OLO_Classi.CONSEGNA_APPARATO_element>();
	        	
	        	for(EOF_EAI_Service_Log__C sLog : sList){
	        		
	        		if(sLog.EOF_Tipo_COmunicazione_String__c=='CPE'){ //controllare se lo passiamo, in caso
	        			OF_SA_WS_OLO_Classi.CONSEGNA_APPARATO_element app = new OF_SA_WS_OLO_Classi.CONSEGNA_APPARATO_element();
		        		app.TIPOLOGIA_APPARATO=sLog.EOF_TIPOLOGIA_APPARATO__C;
			        	app.ESITO_CONSEGNA_APPARATO=sLog.EOF_ESITO_CONSEGNA_APPARATO__c;
			        	app.ID_APPARATO_CONSEGNATO=sLog.OF_SA_ID_APPARATO_CONSEGNATO__c;
        				app.CODICE_MOTIVAZIONE_CONSEGNA=sLog.OF_SA_CODICE_MOTIVAZIONE_CONSEGNA__c;
        				app.MOTIVAZIONE_CONSEGNA=sLog.OF_SA_MOTIVAZIONE_CONSEGNA__c;
		        		request_x.APPARATO.add(app); 
	        		}
	        		
	        		if(sLog.EOF_Tipo_COmunicazione_String__c=='SERVIZIO AGGIUNTIVO'){
	        			OF_SA_WS_OLO_Classi.SERVIZIO_AGGIUNTIVO_element sa = new OF_SA_WS_OLO_Classi.SERVIZIO_AGGIUNTIVO_element();
		        		sa.NOME_SERVIZIO=sLog.OF_SA_NOME_SERVIZIO__c; 
		        		sa.ESITO_SERVIZIO=sLog.OF_SA_ESITO_SERVIZIO__c;
		        		sa.CODICE_MOTIVAZIONE_SERVIZIO=sLog.OF_SA_CODICE_MOTIVAZIONE_SERVIZIO__c; 
						sa.MOTIVAZIONE_SERVIZIO=sLog.OF_SA_MOTIVAZIONE_SERVIZIO__c;
		        		request_x.SERVIZIO_AGGIUNTIVO.add(sa); 
	        		} 
	        		
		        } 
            }
            
            OF_SA_WS_OLO_Response.Esito_element response_x;
            Map<String, OF_SA_WS_OLO_Response.Esito_element> response_map_x = new Map<String, OF_SA_WS_OLO_Response.Esito_element>();
            response_map_x.put('response_x', response_x);
            WebServiceCallout.invoke(
              this,
              request_x,
              response_map_x,
              new String[]{endpoint_x,
              '/NotifyCompletamentoOrdine',
              'http://enel.it/schemas/class/ServiziAttivi/NotificaCompletamentoOrdineGpona',
              'NotificaOrdineGpona',
              'http://enel.it/schemas/class/ServiziAttivi/Esito',
              'Esito',
              'OF_SA_WS_OLO_Response.Esito_element'}
            );
            response_x = response_map_x.get('response_x');
            
            //creo l'xml per il service log
    		slToUpdate.EOF_Richiesta_Notifica__c = OF_SA_GE_UTils.copy_request(request_x);
            //update slToUpdate;
            return response_x;
        }
    }
}